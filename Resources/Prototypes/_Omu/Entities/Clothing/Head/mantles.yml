# (READ THIS!) About ComponentToggler for mantles:
#     The ComponentToggler component on each of these mantles is turned ON when the mantle is worn by a beast, and turned OFF when anybody unequips the mantle.
# When you create a new mantle, which inherits from the base one, and you want to add a component to the component toggler, unfortunately you have to just
# copy over the parent's ComponentToggler 1:1 into your new mantle. It results in a lot of duplicate markup. I hate it. But I don't know how I'd do it any better.
#
# (Extra reading) On Balance:
#     The cybernetic beast trait is balanced around opportunity costs. That is to say, you gain some pretty nice benefits from wearing a mantle, but your mantle
# can't do everything. You eventually will need to put on another helmet, or set of glasses, or facemask, and in order to do that, you must accept some downsides
# in return. For instance, if you're a tider, your mantle provides you with some basic upsides: night vision, flash resistance, vision correction. However,
# if the station is spaced, you will need to use internals, which you don't have. So you must take off the mantle and deal with being nearsighted
# for the time being. As well, the mantle is large, at 4x4 inventory slots, meaning that in a worst-case emergency you may need to drop it entirely and come
# back for it later.
#     Some concessions have been made for certain jobs. A salvager will need to go out into space, so they get internals and pressure resistance. Same with an
# atmos technician. As well, a doctor probably needs a medhud for their job. The key is to give the player ONLY what is necessary to complete their job. A
# doctor probably doesn't need to be spaceproofed to do their job, at least until the station goes belly up, at which point they __should__ have to play around the 
# opportunity cost of having a mantle.
#
# (Extra, Extra reading) On Balance, holistically:
#    The "opportunity cost" style of balance came about as a result of some discussions in the OmuStation discord about trait balancing. One of the sentiments which
# I observed, was that traits should have inherent downsides. If you make traits only-positive or only-negative, and rely on the trait points system to balance for
# you, "meta" traits will VERY quickly emerge and dominate the playstyle of the server. However, if mostly-positive traits have a downside, or mostly-negative traits
# have something desireable, then traits tend towards personal preference instead of optimal gameplay. It also allows for much more targeted balance: If the problem
# with a trait is that people abuse it in combination with something else, you kind of have to gimp one trait or the other, and your only real way to do that is
# via points cost. However, if a trait is both positive- and negative, you can alter those negatives in any which way you like.

# The base mantle.
- type: entity
  parent: ClothingHeadBase
  id: ClothingCyberneticBeastMantle
  name: beast's mantle
  description: The mantlepiece to sit atop a cybernetic beast. It comes equipped with features to assist the Beast's vision; but should it be taken away, it will leave a Beast crippled.
  components:
  - type: CyberneticMantle
  - type: ItemToggle
    onUse: false
    onActivate: false
    predictable: true
  - type: ComponentToggler
    components:
    - type: VisionCorrection
      correctionPower: 16 # these ain't your granny's reading glasses 
    - type: NightVision
      isEquipment: true
      color: "#CCFFCC" #todo: make this correspond to the colour of the beast's eyes
    - type: FlashImmunity
    - type: FlashSoundSuppression
  - type: Sprite
    sprite: _Omu/Clothing/Head/mantle.rsi
  - type: Clothing
    sprite: _Omu/Clothing/Head/mantle.rsi
    clothingVisuals:
      head:
      - state: helmet
      - state: eyes
        shader: unshaded
  - type: PointLight # the glow is subtle. It's just enough to make the mantle visible in pitch black lighting, but won't help you see much.
    radius: 1.45
    energy: 0.6
    offset: 0,0.2
    color: "#CCFFCC" # this will match the colour of the beast's eyes when worn, this is just a default.
    mask: /Textures/Effects/LightMasks/cone.png
    autoRot: true
    containerOccluded: true # this makes the mantle illuminate itself.
  - type: ClothingTakesUpExtraSlots
    slots:
    - mask 
    - eyes
  - type: StealTarget
    stealGroup: CyberneticMantles
  - type: Item
    size: Huge

# This mantle is inteded for people doing jobs that require internals. In particular, this mantle is a breath mask with pressure protection.
- type: entity
  id: ClothingCyberneticBeastMantleWork
  parent: ClothingCyberneticBeastMantle
  name: beast's work mantle
  description: A modified version of a cybernetic beast's mantle. This one comes with hookups for internals, and has extra seals for atmospheric protection.
  components:
  - type: Sprite
    sprite: _Omu/Clothing/Head/mantle.rsi
    state: icon-work
  - type: Clothing
    sprite: _Omu/Clothing/Head/mantle.rsi
    clothingVisuals:
      head:
      - state: helmet
      - state: helmet-internals
      - state: eyes
        shader: unshaded
  - type: ComponentToggler
    components: # copied from the parent with some additions
    - type: VisionCorrection
      correctionPower: 16
    - type: NightVision
      isEquipment: true
      color: "#CCFFCC"
    - type: FlashImmunity
    - type: FlashSoundSuppression
    - type: BreathMask
    - type: PressureProtection
      highPressureMultiplier: 0.4
      lowPressureMultiplier: 1000

# resprite of the work mantle for engineers.
- type: entity
  id: ClothingCyberneticBeastMantleWorkEngineering
  parent: ClothingCyberneticBeastMantleWork
  name: beast's engineering mantle
  components:
  - type: Clothing
    sprite: _Omu/Clothing/Head/mantle.rsi
    clothingVisuals:
      head:
      - state: helmet-engineering
      - state: helmet-internals
      - state: eyes-engineering
        shader: unshaded

# resprite of the work mantle for salvagers in particular.
- type: entity
  id: ClothingCyberneticBeastMantleWorkSalvage
  parent: ClothingCyberneticBeastMantleWork
  name: beast's salvage mantle
  description: A modified version of a cybernetic beast's mantle. This one has been jury-rigged to mount a flashlight on its snout.
  components:
  - type: Sprite
    sprite: _Omu/Clothing/Head/mantle.rsi
    state: icon-salvage
  - type: Clothing
    sprite: _Omu/Clothing/Head/mantle.rsi
    clothingVisuals:
      head:
      - state: helmet-salvage
      - state: helmet-internals
      - state: eyes-salvage
        shader: unshaded
  - type: PointLight # salvagers get a light with fairly substantial range on their mantle. yes they already have night vision, but it might be nice for fellow salvagers (and is just kind of cool)
    radius: 5
    energy: 0.45 # lower energy, so that it's not too distracting outside of salvage operations.
    offset: 0,0.2
    color: "#CCFFCC"

# resprite of the standard mantle with a sechud.
- type: entity
  id: ClothingCyberneticBeastMantleSecurity
  parent: [ClothingCyberneticBeastMantle, BaseSecurityContraband]
  name: beast's security mantle
  description: A modified version of a cybernetic beast's mantle. This one comes with an included sechud.
  components:
  - type: Sprite
    sprite: _Omu/Clothing/Head/mantle.rsi
    state: icon-security
  - type: Clothing
    sprite: _Omu/Clothing/Head/mantle.rsi
    clothingVisuals:
      head:
      - state: helmet-security
      - state: eyes-security
        shader: unshaded
  - type: ComponentToggler # copied from the parent with some additions.
    components:
    - type: VisionCorrection
      correctionPower: 16
    - type: NightVision
      isEquipment: true
      color: "#CCFFCC"
    - type: FlashImmunity
    - type: FlashSoundSuppression
    - type: ShowJobIcons
    - type: ShowMindShieldIcons
    - type: ShowCriminalRecordIcons
    - type: ShowContrabandDetails
    - type: Armor # Gives the same level of protection as the security beret.
      coverage:
      - Head
      traumaDeductions:
        Dismemberment: 0.2
        OrganDamage: 0.2
        BoneDamage: 0.2
        VeinsDamage: 0
        NerveDamage: 0
      modifiers:
        coefficients:
          Blunt: 0.7
          Slash: 0.7
          Piercing: 0.7
          Heat: 0.8

# resprite of the standard mantle with a medhud.
- type: entity
  id: ClothingCyberneticBeastMantleMedical
  description: A modified version of a cybernetic beast's mantle. This one comes with an included medhud.
  parent: ClothingCyberneticBeastMantle
  name: beast's medical mantle
  components:
  - type: Sprite
    sprite: _Omu/Clothing/Head/mantle.rsi
    state: icon-medical
  - type: Clothing
    sprite: _Omu/Clothing/Head/mantle.rsi
    clothingVisuals:
      head:
      - state: helmet-medical
      - state: eyes-medical
        shader: unshaded
  - type: ComponentToggler # copied from the parent with some additions.
    components:
    - type: VisionCorrection
      correctionPower: 16
    - type: NightVision
      isEquipment: true
      color: "#CCFFCC"
    - type: FlashImmunity
    - type: FlashSoundSuppression
    - type: ShowHealthBars
    - type: ShowHealthIcons

# Mantle for the BSO, this one is a little weird:
# We give the BSO all the huds they would normally get from their glasses, and we give them pressure protection, but NOT internals.
# The BSO's job description (protect command) doesn't strictly speaking require going into space, but realistically the BSO probably
# will have to. But I don't want to make the mantle a no-brainer item for the BSO to have. So, it gets pressure protection.
# Pressure protection will reward spontaneous decision making (if I go out there NOW and save the captain quick, I'll get off scott free)
# but it still makes extended trips into space unlikely without forcing the BSO to play around the balance of the trait.

- type: entity
  id: ClothingCyberneticBeastMantleBlueshieldOfficer
  parent: [ClothingCyberneticBeastMantle, BaseCentcommContraband]
  name: beast's BSO mantle
  description: A modified version of a cybernetic beast's mantle. This one comes with standard BSO huds, and seals for pressure protection.
  components:
  - type: Sprite
    sprite: _Omu/Clothing/Head/mantle.rsi
    state: icon-bso
  - type: Clothing
    sprite: _Omu/Clothing/Head/mantle.rsi
    clothingVisuals:
      head:
      - state: helmet-bso
      - state: eyes-bso
        shader: unshaded
  - type: ComponentToggler # copied from the parent with some additions.
    components:
    - type: VisionCorrection
      correctionPower: 16
    - type: NightVision
      isEquipment: true
      color: "#CCFFCC"
    - type: FlashImmunity
    - type: FlashSoundSuppression
    - type: ShowJobIcons
    - type: ShowMindShieldIcons
    - type: ShowHealthBars
      damageContainers:
      - Biological
      - Inorganic
      - Silicon
      - SiliconRadiation # Goobstation - Make IPCs take radiation
    - type: ShowHealthIcons
      damageContainers:
      - Biological
    - type: BreathMask
    - type: PressureProtection
      highPressureMultiplier: 0.4
      lowPressureMultiplier: 1000
    - type: Armor # Gets the same level of protection as the BSO beret gives.
      coverage:
      - Head
      traumaDeductions:
        Dismemberment: 0.3
        OrganDamage: 0.3
        BoneDamage: 0.3
        VeinsDamage: 0
        NerveDamage: 0
      modifiers:
        coefficients:
          Blunt: 0.3
          Slash: 0.3
          Piercing: 0.3
          Heat: 0.3
          Radiation: 0.75
          Caustic: 0.75
    - type: ExplosionResistance
      damageCoefficient: 0.75

# Command members who need job specific mantles just get their job mantles.
# Command members who don't get this. It's no better than the base mantle, but it looks schweet.
- type: entity
  parent: [ClothingCyberneticBeastMantle, BaseCommandContraband]
  id: ClothingCyberneticBeastMantleCommand
  name: beast's command mantle
  components:
  - type: Sprite
    sprite: _Omu/Clothing/Head/mantle.rsi
    state: icon-command
  - type: Clothing
    sprite: _Omu/Clothing/Head/mantle.rsi
    clothingVisuals:
      head:
      - state: helmet-command
      - state: eyes-command
        shader: unshaded